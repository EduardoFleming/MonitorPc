import streamlit as st
import time

import hardwareInfo
import hardwareMonitoring

# --- CONFIGURA√á√ÉO DA P√ÅGINA ---
# Isso deve ser o primeiro comando do Streamlit no seu script
st.set_page_config(
    page_title="Monitor de Hardware",
    page_icon="üñ•Ô∏è",
    layout="wide"
)

# --- T√çTULO PRINCIPAL DA APLICA√á√ÉO ---
st.title("üñ•Ô∏è Software de Monitoramento de Hardware")

# --- BUSCA OS DADOS EST√ÅTICOS (s√≥ precisa fazer uma vez) ---
processorName = hardwareInfo.getCpuInfo()
gpuName = hardwareInfo.getGpuInfo()
motherboardName = hardwareInfo.getMotherboardInfo()
ramAmount = hardwareInfo.getRamInfo()
diskInfoList = hardwareInfo.getDiskInfo()

# --- CRIA√á√ÉO DAS ABAS ---
tab1, tab2 = st.tabs(["üìä Informa√ß√µes do PC", "üìà Monitoramento em Tempo Real"])

# --- CONTE√öDO DA ABA 1: Informa√ß√µes Est√°ticas ---
with tab1:
    st.header("Especifica√ß√µes de Hardware")

    # Para cada informa√ß√£o, usamos um subheader e o st.code()
    # que j√° vem com um bot√£o de "copiar" embutido!
    st.subheader("Processador")
    st.code(processorName, language=None)

    st.subheader("Placa de V√≠deo (GPU)")
    st.code(gpuName, language=None)

    st.subheader("Placa-M√£e")
    st.code(motherboardName, language=None)

    st.subheader("Mem√≥ria RAM Total")
    st.code(ramAmount, language=None)

    st.subheader("Parti√ß√µes de Disco")
    for disk in diskInfoList:
        st.code(disk, language=None)

# --- CONTE√öDO DA ABA 2: Monitoramento em Tempo Real ---
with tab2:
    st.header("Uso de Recursos Atuais")

    # Criamos um "espa√ßo reservado" na tela que vamos atualizar
    placeholder = st.empty()

    # Loop infinito para manter os dados atualizados
    while True:
        # Pega os dados mais recentes do hardware
        cpu_usage = hardwareMonitoring.getCpuUsage()
        ram_usage = hardwareMonitoring.getRamUsage()
        gpu_stats = hardwareMonitoring.getGpuUsage()

        # Usa o placeholder para redesenhar a se√ß√£o de monitoramento
        with placeholder.container():
            # Cria 3 colunas para organizar os dados
            col1, col2, col3 = st.columns(3)

            # Coluna da CPU
            with col1:
                st.metric(label="Uso da CPU", value=f"{cpu_usage}%")
            
            # Coluna da RAM
            with col2:
                st.metric(label="Uso de RAM", value=f"{ram_usage}%")

            # Coluna da GPU
            with col3:
                st.metric(label="Uso da GPU", value=gpu_stats["usage"])
                st.metric(label="Temp. da GPU", value=gpu_stats["temp"])
            
            # Espera 2 segundos antes de atualizar novamente
            time.sleep(2)